import{r as i,j as e,y,a as G}from"./app-03bf7fb2.js";import{f as A,d as k,e as S,A as B,c as C}from"./index-a4fe23a0.js";import{F as p}from"./index.es-c79b7abf.js";import{B as f,Q as P}from"./ReactToastify-695b0e60.js";import{S as F}from"./react-select.esm-ae8c0d08.js";import"./Dropdown-4a4abfbc.js";import"./TextInput-ad7fe8bb.js";import"./clsx-0839fdbe.js";import"./emotion-react.browser.esm-45e7cdef.js";function R(r){const[t,n]=i.useState(null),[o,m]=i.useState([]),[d,b]=i.useState(null),[h,u]=i.useState(null),g=l=>{if(t&&t.id===l.id)w();else{n(l);const c=`${l.id}-${l.name}`,j=r.roleAssignations[c];m(j)}},w=()=>{n(null),m([])},[N,v]=i.useState(r.users),s=l=>{if(!l){v(r.users);return}const c=r.users.filter(j=>j.name.toLowerCase().includes(l.toLowerCase()));v(c)},a=(l,c)=>{if(!t){f.error("Veuillez d'abord sélectionner un utilisateur");return}console.log("Role",l),console.log("User",c);const j={role_id:l.id,user_id:c.id};y.post("/superadmin/addRoleToUser",{data:j}),n(null),f.success("Role added")},x=(l,c)=>{if(!t){f.error("Veuillez d'abord sélectionner un utilisateur");return}console.log("Role",l),console.log("User",c);const j={role_id:l.id,user_id:c.id};y.post("/superadmin/removeRoleFromUser",{data:j}),n(null),b(c),u(c),f.success("Role removed")};return i.useEffect(()=>{d&&(n(null),b(null))},[t,n]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"h-full w-full flex flex-row space-x-2",children:[e.jsxs("div",{className:"glassmorphism w-full h-full p-2 flex flex-col items-center space-y-2",children:[e.jsxs("div",{className:"flex flex-row w-full space-x-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-primGrey font-bold text-2xl",children:"Liste des Utilisateurs"})}),e.jsxs("div",{className:"counteredGlass px-4",children:[e.jsx(p,{icon:A,className:"text-primGrey"}),e.jsx("input",{type:"text",placeholder:"Rechercher un utilisateur",className:"bg-transparent  placeholder-adminAquaBlue focus:ring-0 border-none text-primGrey",onChange:l=>s(l.target.value)})]})]}),e.jsxs("table",{className:"w-full table-fixed border-collapse border-t-2 border-t-glassStroke",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-b-primBlue",children:[e.jsxs("th",{className:"w-1/5",children:[" ",e.jsx("h2",{className:"text-primGrey font-bold text-x ",children:"Nom de l'Utilisateur"})]}),e.jsx("th",{className:"w-3/5",children:e.jsx("h2",{className:"text-primGrey font-bold text-xl",children:"Email associé"})}),e.jsx("th",{className:"w-1/5",children:e.jsx("h2",{className:"text-primGrey font-bold text-xl",children:"Action disponible"})})]})}),e.jsx("tbody",{children:N.map(l=>e.jsxs("tr",{className:t&&t.id===l.id?"border-2 border-green-500":"",children:[e.jsx("td",{children:e.jsx("h2",{className:"text-primGrey",children:l.name})}),e.jsx("td",{children:e.jsx("h2",{className:"text-primGrey",children:l.email})}),e.jsx("td",{children:e.jsx("div",{className:"hover:bg-adminLightPink transition-colors duration-300 w-full group rounded-lg flex flex-row items-center justify-center",children:e.jsx("button",{onClick:()=>g(l),children:t&&t.id===l.id?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-row justify-start space-x-2 items-center ",children:[e.jsx(p,{icon:k,className:"text-adminDarkPink group-hover:text-primGrey"}),e.jsx("h2",{className:"text-adminLightPink group-hover:text-adminDarkPurple",children:"Selection Actuelle"})]})}):e.jsxs("div",{className:"flex flex-row justify-start space-x-2 items-center",children:[e.jsx(p,{icon:S,className:"text-adminDarkBlue group-hover:text-primGrey"}),e.jsx("h2",{className:"text-adminDarkBlue group-hover:text-adminDarkPurple",children:"Choisir"})]})})})})]},l.id))})]})]}),e.jsxs("div",{className:"space-y-2 w-4/12 h-full flex flex-col",children:[e.jsx("div",{className:"glassmorphism w-full h-1/4 flex flex-col justify-end items-center p-2",children:t?e.jsxs(e.Fragment,{children:[t.image?e.jsx("img",{src:t.image,alt:"User Image",className:"w-20 h-20 rounded-full"}):e.jsx("div",{className:"w-20 h-20 rounded-full bg-adminLightBlue flex items-center justify-center text-6xl text-primRed",children:t.name.charAt(0)}),e.jsx("h2",{className:"text-primGrey font-bold text-2xl",children:t.name}),e.jsx("h2",{className:"text-primGrey font-bold text-m",children:t.email})]}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"h-full w-full justify-center items-center flex",children:e.jsx("h2",{className:"text-adminDarkBlue font-bold text-xl",children:"Aucun utilisateur selectionné"})})})}),e.jsx("div",{className:"glassmorphism w-full h-full flex flex-col p-2",children:t?e.jsx(e.Fragment,{children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left",children:"Nom du Rôle"}),e.jsx("th",{className:"text-left",children:"Attribué"}),e.jsx("th",{className:"text-left",children:"Actions"})]})}),e.jsx("tbody",{children:r.roles.map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:l.name}),e.jsx("td",{children:o&&o.includes(l.name)?"Oui":"Non"}),e.jsx("td",{children:o&&o.includes(l.name)?e.jsx(e.Fragment,{children:e.jsx("button",{className:"hover:bg-red-200 w-full rounded-lg",onClick:()=>{x(l,t)},children:e.jsxs("div",{className:"flex flex-row justify-start space-x-2 items-center",children:[e.jsx(p,{icon:k,className:"text-primRed"}),e.jsx("h2",{className:"text-primRed",children:"Retirer"})]})})}):e.jsx(e.Fragment,{children:e.jsx("button",{className:"hover:bg-green-200 w-full rounded-lg",onClick:()=>{a(l,t)},children:e.jsxs("div",{className:"flex flex-row justify-start space-x-2 items-center",children:[e.jsx(p,{icon:S,className:"text-green-500"}),e.jsx("h2",{className:"text-primBlue hover:text-green-500",children:"Ajouter"})]})})})})]},l.id))})]})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"h-full w-full justify-center items-center flex",children:e.jsx("h2",{className:"text-adminDarkBlue font-bold text-xl",children:"Aucun utilisateur selectionné"})})})})]})]})})}function D(r){const[t,n]=i.useState(r.permissions),[o,m]=i.useState([]),[d,b]=i.useState(null),[h,u]=i.useState(null),g=s=>{if(!s){n(r.permissions);return}const a=r.permissions.filter(x=>x.name.toLowerCase().includes(s.toLowerCase()));n(a)},w=s=>{m(a=>a.includes(s)?a.filter(x=>x!==s):[...a,s]),console.log(o)},N=r.roles.map(s=>({value:s.id,label:s.name}));console.log(r.permissionAssignations),i.useEffect(()=>{if(h==="def"){if(!d){f.error("Veuillez selectionner un rôle"),u(null);return}m([])}else if(h==="edit"){if(!d){f.error("Veuillez selectionner un rôle"),u(null);return}var s=r.permissionAssignations[d];console.log(s);var s=s.map(a=>r.permissions.find(x=>x.name===a));console.log(s),m(s),g()}},[h]);const v=()=>{if(!d){f.error("Veuillez selectionner un rôle");return}const s=o.map(x=>x.name),a={role:d,permissions:s};y.post("/superadmin/editPermissionsOfRole",{data:a}),f.success("Permissions modifiées avec succès"),u(null),m([])};return i.useEffect(()=>{m([]),u(null),g()},[d]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:"h-full w-full flex flex-row space-x-2 overflow-clip",children:[e.jsxs("div",{className:"glassmorphism w-3/5 max-h-[calc(100vh-8rem)] p-2 flex flex-col items-center space-y-2",children:[e.jsxs("div",{className:"flex flex-row w-full h-fit justify-between items-end border-b-glassStroke border-b-2 pb-2",children:[e.jsx("div",{className:"text-primGrey font-bold text-2xl ",children:"Liste des Permissions"}),e.jsxs("div",{className:"counteredGlass px-4 w-1/2 flex items-center",children:[e.jsx(p,{icon:A,className:"text-primGrey"}),e.jsx("input",{type:"text",placeholder:"Rechercher une permission",className:"bg-transparent placeholder-adminAquaBlue focus:ring-0 border-none text-primGrey w-full",onChange:s=>g(s.target.value)})]})]}),e.jsx("div",{className:"w-full h-full overflow-y-auto",children:t.map(s=>e.jsx("div",{className:`w-11/12 p-2 rounded-full ${o.includes(s)?"text-green-500 text-bold text-xl":"text-primGrey"}`,onClick:()=>w(s),children:s.name},s.id))})]}),e.jsxs("div",{className:"w-2/5 h-full flex flex-col-reverse space-y-2 space-y-reverse",children:[e.jsxs("div",{className:"glassmorphism w-full h-3/4 flex flex-col items-center p-2 space-y-2",children:[e.jsx("div",{className:"text-adminDarkBlue font-bold text-xl border-b-2 border-b-glassStroke w-full text-center pb-2",children:d?"Apercu pour  "+d:"Veuillez selectionner un rôle"}),e.jsx("div",{className:"w-full flex flex-col items-center overflow-y-auto",children:o.map(s=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full text-primGrey",children:s.name},s.id)}))}),e.jsx("div",{className:"py-1 tracking-wider rounded-full bg-primGrey text-center px-8 text-adminLightPink text-xl border-2 border-glassStroke hover:text-adminAquaBlue hover:glassmorphism",onClick:()=>{v()},children:h==="def"?"Définir les permissions":"Modifier les permissions"})]}),e.jsxs("div",{className:"glassmorphism w-full h-1/4 flex flex-col items-center p-2",children:[e.jsx("div",{className:"text-adminDarkBlue font-bold text-xl border-b-2 border-b-glassStroke w-full text-center pb-2",children:"Selectonnez un rôle pour voir l'aperçu et modifer"}),e.jsxs("div",{className:"w-full h-full space-y-2 justify-center items-center flex flex-col",children:[e.jsx(F,{className:"w-full p-2 rounded-f focus:ring-0 border-none text-adminAquaBlue z-50",defaultValue:N[1],options:N,onChange:s=>b(s.label)}),e.jsxs("div",{className:"flex flex-row w-full items-center justify-center",children:[e.jsx("div",{className:`w-60 text-center font-bold text-xl hover:glassmorphism ${h==="def"?"text-adminAquaBlue border-2 rounded-full border-adminAquaBlue":"text-adminDarkBlue"}`,onClick:()=>u("def"),children:"Definition"}),e.jsx("div",{className:`w-60 text-center font-bold text-xl hover:glassmorphism ${h==="edit"?"text-adminAquaBlue border-2 rounded-full border-adminAquaBlue":"text-adminDarkBlue"}`,onClick:()=>u("edit"),children:"Modification"})]})]})]})]})]})})}function T(r){const[t,n]=i.useState("General");return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Manager"}),e.jsx("div",{className:"absolute top-4 right-4 z-10",children:e.jsx(P,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!0,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})}),e.jsxs("div",{className:"h-screen w-screen bg-gradient-radial from-adminDarkPink to-adminDarkBlue flex",children:[e.jsxs("div",{className:"flex flex-col w-1/5 h-screen",children:[e.jsx("div",{className:"h-32 w-full items-center justify-center pl-8 pt-4",children:e.jsx(B,{})}),e.jsxs("div",{className:"h-full px-8 flex flex-col space-y-4 pt-8",children:[e.jsx("div",{className:t==="General"?"w-full text-adminAquaBlue border-b-2 border-b-adminAquaBlue font-bold text-2xl":"w-full text-white font-bold text-2xl",onClick:()=>{n("General")},children:"General"}),e.jsx("div",{className:t==="Permissions"?"w-full text-adminAquaBlue border-b-2 border-b-adminAquaBlue font-bold text-2xl":"w-full text-white font-bold text-2xl",onClick:()=>{n("Permissions")},children:"Permissions"})]})]}),e.jsxs("div",{className:"flex h-screen w-4/5 flex-col",children:[e.jsx("div",{className:"h-32 w-full flex flex-row-reverse items-center px-8",children:e.jsxs("div",{className:" p-3 rounded-2xl space-x-2 flex flex-row items-center justify-center glassmorphism w-fit h-fit px-8",children:[e.jsx(p,{icon:C,className:"text-l capitalize font-bold text-primGrey"}),e.jsx("h2",{className:"text-l capitalize font-bold text-primGrey",children:r.user.name.split(" ")[0]})]})}),e.jsx("div",{className:"max-h-[calc(100vh-8rem)] h-full w-full pr-8 pb-8",children:t==="General"?e.jsx(e.Fragment,{children:e.jsx(R,{...r})}):t==="Permissions"?e.jsx(e.Fragment,{children:e.jsx(D,{...r})}):e.jsx(e.Fragment,{children:"ca existe pas encore"})})]})]})]})}export{T as default};
